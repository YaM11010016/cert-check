<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>证书查看</title>
  <style>
    body, html { margin:0; height:100vh; }
  </style>
</head>
<body>
  <div id="container" style="height:100%;"></div>

  <script>
    // 证书数据
    const certData = {
      '12345': 'https://drive.google.com/file/d/15kDxKHri7_7AFYFpkr5oZdAlXg8Hlfyo/view?usp=drive_link',
      // 你可以继续添加更多证书
    };

    // 获取URL参数
    function getQueryParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    // 从谷歌云盘分享链接提取文件ID
    function getGoogleDriveFileId(url) {
      const match = url.match(/\/d\/([a-zA-Z0-9_-]+)/);
      return match ? match[1] : null;
    }

    // 转换为直链
    function getDirectLink(fileId) {
      return `https://drive.google.com/uc?export=download&id=${fileId}`;
    }

    const certid = getQueryParam('certid');
    const container = document.getElementById('container');

    if (certid && certData[certid]) {
      const fileId = getGoogleDriveFileId(certData[certid]);
      if (fileId) {
        const directLink = getDirectLink(fileId);
        container.innerHTML = `<embed src="${directLink}" width="100%" height="100%" type="application/pdf" />`;
      } else {
        container.innerHTML = '证书链接格式不正确';
      }
    } else {
      container.innerHTML = '证书不存在或无效';
    }
  </script>
</body>
</html>
<!-- 测试修改 -->
